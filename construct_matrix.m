function B = construct_matrix(th,gamma)
%    B = zeros(16);
    B = sym(zeros(16, 16));
    nu = (1+th)/2;
  B(1,1) = -4*(1-nu);
  B(2,1) = nu;
  B(3,1) = nu;
  B(5,1) = nu;
  B(9,1) = nu;
  B(1,2) = 1 - nu;
  B(2,2) = -3*(1-nu) - nu;
  B(4,2) = nu;
  B(6,2) = nu;
  B(10,2) = nu;
  B(1,3) = 1-nu;
  B(3,3) = -2*(1-nu) - nu;
  B(7,3) = nu;
  B(11,3) = nu;
  B(2,4) = 1-nu;
  B(4,4) = -2*(1-nu) - nu;
  B(8,4) = nu;
  B(12,4) = nu;
  B(1,5) = 1-nu;
  B(5,5) = -(1-nu) - nu;
  B(13,5) = nu;
  B(2,6) = 1-nu;
  B(6,6) = -(1-nu) - nu;
  B(14,6) = nu;
  B(3,7) = 1-nu;
  B(7,7) = -(1-nu) - nu;
  B(15,7) = nu;
  B(4,8) = 1-nu;
  B(8,8) = -(1-nu) - nu;
  B(16,8) = nu;
  B(1,9) = 1-nu;
  B(9,9) = -nu;
  B(2,10) = 1-nu;
  B(10,10) = -nu;
  B(3,11) = 1-nu;
  B(11,11) = -nu;
  B(4,12) = 1-nu;
  B(12,12) = -nu;
  B(5,13) = 1-nu;
  B(13,13) = -nu;
  B(6,14) = 1-nu;
  B(14,14) = -nu;
  B(7,15) = 1-nu;
  B(15,15) = -nu;
  B(8,16) = 1-nu;
  B(16,16) = -nu;
  B = B' - gamma*eye(16);
end
