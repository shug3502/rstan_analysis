---
title: "Models"
author: "Jonathan Harrison"
date: "30/08/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.width=6, fig.height=4,
                      echo=FALSE, warning=FALSE, message=FALSE)
```

#Notes for 30th August 2018. 

There are three main models which I am currently considering for RNA localization:

1. Full model
2. Non uniform bias, $\nu$
3. Hierarchical

We will consider these models, attempt to fit them to data, and perform model comparison.
Importantly, we will begin with simulating from the models to give samples from the prior predictive distribution.
This should demonstrate the flexibility of each of the models and help evaluate our choice of prior distributions. 

```{r}
source('mrna_transport_full.R')
res = mrna_transport_inference_full('prior_pred_full_v261',use_real_data = TRUE, run_mcmc = TRUE, nSamples = 8, nTest = 12, nTestOE = 7, verbose = FALSE, compare_via_loo = FALSE, show_diagnostic_plots = FALSE, use_hierarchical_model = FALSE, use_prior_predictive = TRUE, train_on_OE=FALSE, is_nu_uniform = TRUE)
```

```{r}
source('mrna_transport_full.R')
res = mrna_transport_inference_full('prior_pred_full_v262',use_real_data = TRUE, run_mcmc = TRUE, nSamples = 8, nTest = 12, nTestOE = 7, verbose = FALSE, compare_via_loo = FALSE, show_diagnostic_plots = FALSE, use_hierarchical_model = FALSE, use_prior_predictive = TRUE, train_on_OE=FALSE, is_nu_uniform = FALSE)
```


```{r}
source('mrna_transport_full.R')
res1 = mrna_transport_inference_full('full_nu_uniform_v234',use_real_data = TRUE, run_mcmc = FALSE, nSamples = 8, nTest = 12, nTestOE = 7, verbose = TRUE, compare_via_loo = FALSE, show_diagnostic_plots = TRUE, use_hierarchical_model = FALSE, use_prior_predictive = FALSE, train_on_OE = FALSE, is_nu_uniform = TRUE)

```


```{r}
source('mrna_transport_full.R')
res1 = mrna_transport_inference_full('full_nu_uniform_v250',use_real_data = TRUE, run_mcmc = TRUE, nSamples = 8, nTest = 12, nTestOE = 7, verbose = TRUE, compare_via_loo = FALSE, show_diagnostic_plots = TRUE, use_hierarchical_model = FALSE, use_prior_predictive =FALSE, train_on_OE=FALSE, is_nu_uniform = TRUE)

res2 = mrna_transport_inference_full('full_OE_data_nu_uniform_v251',use_real_data = TRUE, run_mcmc = TRUE, nSamples = 8, nTest = 12, nTestOE = 7, verbose = TRUE, compare_via_loo = FALSE, show_diagnostic_plots = TRUE, use_hierarchical_model = FALSE, use_prior_predictive =FALSE, train_on_OE=TRUE, is_nu_uniform = TRUE)

res3 = mrna_transport_inference_full('full_nu_uniform_v252',use_real_data = TRUE, run_mcmc = TRUE, nSamples = 8, nTest = 12, nTestOE = 7, verbose = TRUE, compare_via_loo = FALSE, show_diagnostic_plots = TRUE, use_hierarchical_model = FALSE, use_prior_predictive =FALSE, train_on_OE=FALSE, is_nu_uniform = TRUE) #with initialisation
```




